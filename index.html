<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>main</title>
    <link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="http://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
    <script type="text/javascript"
        src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=ijdya8hea0"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.css"
        integrity="sha512-6lLUdeQ5uheMFbWm3CP271l14RsX1xtx+J5x2yeIDkkiBpeVTNhTqijME7GgRKKi6hCqovwCoBTlRBEC20M8Mg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./css/initialize.css">
    <link rel="stylesheet" href="./css/headerFooter.css">
    <link rel="stylesheet" href="./css/mainpage.css">
    <link rel="stylesheet" href="./css/mapCard.css">

    <style>
        * {
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>

    <header class="header">
        <ul class="nav menu_box">
            <div class="nav menu">
                <li>행사리스트</li>
                <li>문의사항</li>
            </div>

            <div>
                <li class="nav logo">
                    <img src="./서울구석구석로고.png">
                </li>
            </div>

            <div class="nav menu">
                <li>LOGIN</li>
                <li>SIGNUP</li>
            </div>

        </ul>

    </header>

    <main>
        <div>
            <video src="./main_video.mp4" tyep="video.mp4" muted loop autoplay></video>
        </div>

        <br>
        <br>
        <h2>행사 지역</h2>

        <div class="map_container">
            <div class="eventCard">
                <div class="image"></div>
                <div class="eventName font"></div>
                <div class="eventLocation font"></div>
                <div class="eventTime font"></div>
            </div>
            <!-- 네이버 지도 -->
            <div id="map"></div>
        </div>

        <br>
        <br>
        <h2>행사 리스트</h2>

        <div class="festival">
            <div class="festival_container">
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>

            </div>
        </div>

        <div class="festival">
            <div class="festival_container">
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>
                <div class="festival_list">
                    <img src="./카드이미지1.jpg" alt="">
                </div>

            </div>
        </div>
    </main>

    <footer>
        <div class="footer_logo">
            <img src="./서울구석구석로고.png" alt="">
        </div>
        <div>
            <ul class="footer_email_box">
                <li class="footer_email">gkjm123@naver.com</li>
                <li class="footer_email">kon0147@gmail.com</li>
                <li class="footer_email">rlaekqls0504@gmail.com</li>
            </ul>
        </div>
    </footer>


    <script type="text/javascript">
        $('.festival_container').slick({
            dots: true,
            infinite: false,
            speed: 300,
            slidesToShow: 4,
            slidesToScroll: 4,
            responsive: [
                {
                    breakpoint: 1024,
                    settings: {
                        slidesToShow: 3,
                        slidesToScroll: 3,
                        infinite: true,
                        dots: true
                    }
                },
                {
                    breakpoint: 600,
                    settings: {
                        slidesToShow: 2,
                        slidesToScroll: 2
                    }
                },
                {
                    breakpoint: 480,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }

            ]
        });

        // 지도 출력
        let map = new naver.maps.Map('map', {
            center: new naver.maps.LatLng(37.552758094502494, 126.98732600494576),
            zoom: 11
        });

        // 서울시 공공데이터 불러오기 + 왼쪽 카드에 행사 정보 출력
        $.ajax({
            type: "GET",
            url: "http://openapi.seoul.go.kr:8088/4742545152726c6133375046465877/json/culturalEventInfo/1/30/",
            data: {},
            success: function (response) {

                let rows = response["culturalEventInfo"]["row"]
                let marker = [];


                for (let i = 0; i < rows.length; i++) {
                    marker[i] = new naver.maps.Marker({
                        map: map,
                        position: new naver.maps.LatLng(rows[i]["LOT"], rows[i]["LAT"]),
                        icon: {
                            url: "../img/location-pin.png",
                        }
                    });


                    naver.maps.Event.addListener(marker[i], "click", function () {
                        $(".codeName").remove();
                        $(".eventCard").attr("style", " background-image: none")
                        $(".eventName").text(rows[i]["TITLE"])
                        $(".eventLocation").text(rows[i]["PLACE"])
                        $(".eventTime").text(rows[i]["DATE"])
                        $(".eventCard").prepend(`<div class="codeName"></div>`)
                        $(".codeName").text(rows[i]["CODENAME"])
                        let imgUrl = rows[i]["MAIN_IMG"]
                        $(".image").html(`<img src="${imgUrl}" class="festival_img"></img>`)
                        let content = rows[i]["TITLE"]

                        let infoWindow = new naver.maps.InfoWindow({
                            content: content
                        })

                        if (infoWindow.getMap()) {
                            infoWindow.close();
                        } else {
                            infoWindow.open(map, marker[i])
                        }

                    })

                }
            }
        })

    </script>

</body>

</html>